%% Fig. 14. Practical simulation realizations in Gudao Oilfield
clear all;close all;clc;
addpath('../../export_fig-master');
addpath('../../relycode');
figure;
set(gcf,'position', [1,41,1920,962]);
[out, colnames, line1] = loadgeoeas('multiple search trees.out');
data1 = geoeas2matlab(out,[99 94]);
[out, colnames, line1] = loadgeoeas('original Snesim.out');
data2 = geoeas2matlab(out,[99 94]);
[out, colnames, line1] = loadgeoeas('Sisim.out');
data3 = geoeas2matlab(out,[99 94]);
ColorMatrix=[0,139,0;255,255,0];  % Custom legend color 2022.8.22
RGB_RE1 = TI2RGB(data1,ColorMatrix);
RGB_RE2 = TI2RGB(data2,ColorMatrix);
RGB_RE3 = TI2RGB(data3,ColorMatrix);

% Plot multiple search trees realization
axes1=subplot(2,3,1);imshow(RGB_RE1,ColorMatrix./255,'InitialMagnification','fit');
axis on;
axis xy;
title(axes1,{'(a) multiple search trees realization'},'FontSize',14,...
    'position',[49.50015631978384,-15.203817365269398,0]);
set(axes1,'Xlim',[0,99],'Ylim',[0,94],'Clim',[0 2],'FontSize',13);
colorbar('peer',axes1,'Ticks',[0.5 1.5],'TickLabels',{'背景','河道'},'Visible','off');
set(axes1,'XTickLabel',{'6.00','6.48','6.95','7.43','7.90'},...
    'XTick',[0,25,50,75,99],'YTickLabel',{'3.00','3.57','4.04','4.52','4.90'},...
    'YTick',[0,25,50,75,94]);
axes1.Position = [0.2003125,0.583837209302326,0.173996075143102,0.341162790697675];

% Plot original Snesim realization
axes2=subplot(2,3,2);imshow(RGB_RE2,ColorMatrix./255,'InitialMagnification','fit');
axis on;
axis xy;
title(axes2,{'(b) original Snesim realization'},'FontSize',14,...
    'position',[49.50027052085561,-15.203817365269398,0]);
set(axes2,'Xlim',[0,99],'Ylim',[0,94],'Clim',[0 2],'FontSize',13);
colorbar('peer',axes2,'Ticks',[0.5 1.5],...
    'TickLabels',{'background','channel'},'FontSize',14,'Visible','off');
set(axes2,'XTickLabel',{'6.00','6.48','6.95','7.43','7.90'},...
    'XTick',[0,25,50,75,99],...
    'YTickLabel',{'3.00','3.57','4.04','4.52','4.90'},'YTick',[0,25,50,75,94]);

% Plot Sisim realization
axes3=subplot(2,3,3);imshow(RGB_RE3,ColorMatrix./255,'InitialMagnification','fit');
axis on;
axis xy;
title(axes3,{'(c) Sisim realization'},'FontSize',14,...
    'position',[49.50015631978384,-15.203817365269398,0]);
set(axes3,'Xlim',[0,99],'Ylim',[0,94],'Clim',[0 2],'FontSize',13);
colorbar('peer',axes3,'Ticks',[0.5 1.5],'TickLabels',{'background','channel'},...
    'FontSize',14);
set(axes3,'XTickLabel',{'6.00','6.48','6.95','7.43','7.90'},...
    'XTick',[0,25,50,75,99],'YTickLabel',{'3.00','3.57','4.04','4.52','4.90'},...
    'YTick',[0,25,50,75,94]);
axes3.Position = [0.622844202898551,0.583837209302326,0.173996075143102,0.341162790697675];

annotation('textbox','String','Y/(km)','position',...
    [0.199221187396258,0.853394905889228,0.044426493262436,0.071052630245686],'linestyle','none')
annotation('textbox','String','X/(km)','position',...
    [0.348753902150617,0.543331523543418,0.044426493262436,0.071052630245686],'linestyle','none')
annotation('textbox','String','Y/(km)','position',...
    [0.409350268945431,0.853394905889228,0.044426493262436,0.071052630245686],'linestyle','none')
annotation('textbox','String','X/(km)','position',...
    [0.559252297539801,0.543331523543419,0.044426493262436,0.071052630245686],'linestyle','none')
annotation('textbox','String','Y/(km)','position',...
    [0.621934594342257,0.852355404849727,0.044426493262436,0.071052630245686],'linestyle','none')
annotation('textbox','String','X/(km)','position',...
    [0.770535784818446,0.542292022503917,0.044426493262436,0.071052630245686],'linestyle','none')

text(-140.2003282815396,-20.242739520958022,...
    '(A) Practical simulation realizations of Ng3^3 sublayer','FontSize',15);


[out, colnames, line1] = loadgeoeas('multiple search trees Smooth.out');
data1 = geoeas2matlab(out,[99 94]);
[out, colnames, line1] = loadgeoeas('original Snesim Smooth.out');
data2 = geoeas2matlab(out,[99 94]);
[out, colnames, line1] = loadgeoeas('Sisim Smooth.out');
data3 = geoeas2matlab(out,[99 94]);
ColorMatrix=[0,139,0;255,255,0];  % Custom legend color 2022.8.22
RGB_RE1 = TI2RGB(data1,ColorMatrix);
RGB_RE2 = TI2RGB(data2,ColorMatrix);
RGB_RE3 = TI2RGB(data3,ColorMatrix);

% Plot multiple search trees realization
axes1=subplot(2,3,4);imshow(RGB_RE1,ColorMatrix./255,'InitialMagnification','fit');
axis on;
axis xy;
title(axes1,{'(a) multiple search trees realization'},'FontSize',14,...
    'position',[49.50015631978384,-15.203817365269398,0]);
set(axes1,'Xlim',[0,99],'Ylim',[0,94],'Clim',[0 2],'FontSize',13);
colorbar('peer',axes1,'Ticks',[0.5 1.5],'TickLabels',{'背景','河道'},'Visible','off');
set(axes1,'XTickLabel',{'6.00','6.48','6.95','7.43','7.90'},...
    'XTick',[0,25,50,75,99],'YTickLabel',{'3.00','3.57','4.04','4.52','4.90'},...
    'YTick',[0,25,50,75,94]);
axes1.Position = [0.2003125,0.140698544698545,0.173996075143102,0.341162790697675];

% Plot original Snesim realization
axes2=subplot(2,3,5);imshow(RGB_RE2,ColorMatrix./255,'InitialMagnification','fit');
axis on;
axis xy;
title(axes2,{'(b) original Snesim realization'},'FontSize',14,...
    'position',[49.50027052085561,-15.203817365269398,0]);
set(axes2,'Xlim',[0,99],'Ylim',[0,94],'Clim',[0 2],'FontSize',13);
colorbar('peer',axes2,'Ticks',[0.5 1.5],...
    'TickLabels',{'background','channel'},'FontSize',14,'Visible','off');
set(axes2,'XTickLabel',{'6.00','6.48','6.95','7.43','7.90'},...
    'XTick',[0,25,50,75,99],...
    'YTickLabel',{'3.00','3.57','4.04','4.52','4.90'},'YTick',[0,25,50,75,94]);
axes2.Position = [0.410797101449275,0.140698544698545,0.173996075143102,0.341162790697675];

% Plot Sisim realization
axes3=subplot(2,3,6);imshow(RGB_RE3,ColorMatrix./255,'InitialMagnification','fit');
axis on;
axis xy;
title(axes3,{'(c) Sisim realization'},'FontSize',14,...
    'position',[49.50015631978384,-15.203817365269398,0]);
set(axes3,'Xlim',[0,99],'Ylim',[0,94],'Clim',[0 2],'FontSize',13);
colorbar('peer',axes3,'Ticks',[0.5 1.5],'TickLabels',{'background','channel'},...
    'FontSize',14);

set(axes3,'XTickLabel',{'6.00','6.48','6.95','7.43','7.90'},...
    'XTick',[0,25,50,75,99],'YTickLabel',{'3.00','3.57','4.04','4.52','4.90'},...
    'YTick',[0,25,50,75,94]);
axes3.Position = [0.622844202898551,0.140698544698545,0.173996075143102,0.341162790697675];

annotation('textbox','String','Y/(km)','position',...
    [0.199221187396258,0.410080976575313,0.044426493262436,0.071052630245686],'linestyle','none')
annotation('textbox','String','X/(km)','position',...
    [0.348753902150617,0.100017594229491,0.044426493262436,0.071052630245686],'linestyle','none')
annotation('textbox','String','Y/(km)','position',...
    [0.409350268945431,0.410080976575313,0.044426493262436,0.071052630245686],'linestyle','none')
annotation('textbox','String','X/(km)','position',...
    [0.559252297539801,0.100017594229491,0.044426493262436,0.071052630245686],'linestyle','none')
annotation('textbox','String','Y/(km)','position',...
    [0.621934594342257,0.410080976575313,0.044426493262436,0.071052630245686],'linestyle','none')
annotation('textbox','String','X/(km)','position',...
    [0.770535784818446,0.100017594229491,0.044426493262436,0.071052630245686],'linestyle','none')

text(-161.5416456468091,-20.242739520958022,...
    '(B) Practical simulation realizations after smoothing of Ng3^3 sublayer'...
    ,'FontSize',15);

% create textbox
annotation(gcf,'textbox',...
    [0.445833333333332 0.627898129858501 0.0242187494334454 0.0426195416591768],...
    'Color',[0 0 1],...
    'String',{'a'},...
    'FontWeight','bold',...
    'FontSize',18,...
    'EdgeColor','none');

% create ellipse
annotation(gcf,'ellipse',...
    [0.237979166666666 0.604989604989607 0.0427500000000003 0.0613305613305615],...
    'Color',[0 0 1],...
    'LineWidth',2,...
    'LineStyle','--');

% create ellipse
annotation(gcf,'ellipse',...
    [0.237458333333332 0.162162162162164 0.0427500000000004 0.0613305613305616],...
    'Color',[0 0 1],...
    'LineWidth',2,...
    'LineStyle','--');

% create ellipse
annotation(gcf,'ellipse',...
    [0.459854166666666 0.61954261954262 0.0427500000000002 0.0613305613305615],...
    'Color',[0 0 1],...
    'LineWidth',2,...
    'LineStyle','--');

% create ellipse
annotation(gcf,'ellipse',...
    [0.460374999999999 0.177754677754678 0.0427500000000003 0.0613305613305616],...
    'Color',[0 0 1],...
    'LineWidth',2,...
    'LineStyle','--');

% create textbox
annotation(gcf,'textbox',...
    [0.2234375 0.61646361842399 0.0242187494334454 0.0426195416591768],...
    'Color',[0 0 1],...
    'String',{'a'},...
    'FontWeight','bold',...
    'FontSize',18,...
    'EdgeColor','none');

% create textbox
annotation(gcf,'textbox',...
    [0.2234375 0.172596674557042 0.0242187494334455 0.0426195416591768],...
    'Color',[0 0 1],...
    'String',{'a'},...
    'FontWeight','bold',...
    'FontSize',18,...
    'EdgeColor','none');

% create textbox
annotation(gcf,'textbox',...
    [0.445833333333333 0.188189190149556 0.0242187494334454 0.0426195416591768],...
    'Color',[0 0 1],...
    'String',{'a'},...
    'FontWeight','bold',...
    'FontSize',18,...
    'EdgeColor','none');

% Fig. 14. Practical simulation realizations in Gudao Oilfield
export_fig Gudao_simulation_three.jpg -m2.5